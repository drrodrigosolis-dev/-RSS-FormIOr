% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CleaningSimplification.R
\name{collapse_repeated_values}
\alias{collapse_repeated_values}
\title{Resolve repeated answers into one row per submission}
\usage{
collapse_repeated_values(
  x,
  id_col = 1,
  strategy = c("auto", "concat", "first", "last", "sum", "mean", "count", "count_yes"),
  sep = ", ",
  unique = TRUE,
  return_flat = FALSE,
  quiet = FALSE
)
}
\arguments{
\item{x}{A data frame of responses, or a list from \code{\link[=flatten_submission_records]{flatten_submission_records()}}.}

\item{id_col}{Integer or character. Submission ID column (default 1).}

\item{strategy}{One of \code{"auto"}, \code{"concat"}, \code{"first"}, \code{"last"}, \code{"sum"},
\code{"mean"}, \code{"count"}, or \code{"count_yes"}.}

\item{sep}{Separator used for concatenation (default \code{", "}).}

\item{unique}{Logical. If \code{TRUE}, remove duplicate values before concatenating.}

\item{return_flat}{Logical. If \code{TRUE} and \code{x} came from \code{\link[=flatten_submission_records]{flatten_submission_records()}},
include the updated list as \code{flat} in the output.}

\item{quiet}{Logical. If \code{FALSE}, prints a short summary.}
}
\value{
A list with:
\describe{
\item{data}{Collapsed data frame with one row per submission (the cleaned data)}
\item{summary}{Data frame describing how each column was handled}
\item{flat}{If \code{return_flat = TRUE}, the updated flatten_submission_records-style list (for workflows that expect \code{FlatResponses})}
}
}
\description{
Automatically collapses repeated values within each submission ID using a
consistent strategy (or simple heuristics when \code{strategy = "auto"}).
This is a non-interactive alternative to \code{\link[=resolve_duplicate_values]{resolve_duplicate_values()}}.
}
\details{
Note: some FormIO components (for example uploads or address blocks) can
produce list-columns or nested data-frame columns even after flattening.
These values are converted to readable JSON/text before collapsing so the
output remains stable and export-friendly.
If audit logging is active (see \code{\link[=start_audit_log]{start_audit_log()}}), this action is recorded.
}
\examples{
\dontrun{
flat <- flatten_submission_records(fetch_form_responses(form_id = "123", api_key = "abc"))
resolved <- collapse_repeated_values(flat, id_col = "submissionId")
head(resolved$data)
}
}
