% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assign_section_hierarchy.R
\name{assign_section_hierarchy}
\alias{assign_section_hierarchy}
\title{Add Hierarchical Sections to FormIO Response Columns}
\usage{
assign_section_hierarchy(
  x,
  depth = NULL,
  section_names = NULL,
  section_rows = NULL
)
}
\arguments{
\item{x}{A data frame (possibly with nested list-columns), or a list containing \code{FlatResponses} (a flattened data frame) or \code{submission_data} (from \code{fetch_form_responses()} with \code{content.only = FALSE}).}

\item{depth}{Optional section depth (\code{1}, \code{2}, or \code{3}). If \code{NULL}, prompts.}

\item{section_names}{Optional section names by level. Provide a list where
each element is a character vector for one level.}

\item{section_rows}{Optional row assignments by level/section. Provide a list
where each element corresponds to a level and contains row selectors for
each section (numeric vectors, ranges like \code{"1:5"}, or comma strings).}
}
\value{
A list with two elements:
\item{FlatResponses}{The original flattened data frame of responses.}
\item{Sections}{A \code{tibble} with columns \code{No} (column number), \code{Names} (original column names), and \code{Level-1}, \code{Level-2}, \code{Level-3} (section assignments, filled with "General" if empty).}
}
\description{
Assigns hierarchical section labels to columns in flattened FormIO response data
(up to 3 levels deep). You can run it interactively with prompts, or
non-interactively by supplying \code{depth}, \code{section_names}, and \code{section_rows}.
The function handles input that may be a data frame, a list from
\code{flatten_submission_records()}, or raw output from \code{fetch_form_responses()}.
If audit logging is active (see \code{\link[=start_audit_log]{start_audit_log()}}), this action is recorded.
}
\details{
The function first extracts or flattens the input to obtain a flat data frame of responses. It then prompts the user to:
\itemize{
\item Select the depth of sections (1, 2, or 3).
\item Provide comma-separated names for sections at each level (no spaces or special characters).
\item Assign row numbers (from the displayed column list) to each section at each level. Row numbers can be single values, comma-separated lists, or ranges (e.g., "1:5,8,10:12").
}
If \code{depth}, \code{section_names}, and \code{section_rows} are supplied, prompts are
skipped and the function runs non-interactively. Empty assignments are filled
with "General". The interactive prompt flow uses console clearing (\code{\014})
and colored prompts (requires the \code{crayon} package).
}
\examples{
\dontrun{
# Assuming FoodTypes is a sample dataset with possible nests
data("FoodTypes")
sectioned <- assign_section_hierarchy(FoodTypes)
print(sectioned$Sections)
}

}
